{"version":3,"file":"lib.js","sources":["../../src/api/legendSets.js","../../src/api/organisationUnits.js","../../src/assets/ArrowUpwardIcon.js","../../src/assets/ArrowDownwardIcon.js","../../src/ContextualMenu.js","../../src/ChartPlugin.js","../../src/PivotPlugin.js","../../src/api/analytics.js","../../src/modules/analytics.js","../../src/modules/options.js","../../src/modules/getRequestOptions.js","../../src/modules/fetchData.js","../../src/styles/VisualizationPlugin.style.js","../../src/VisualizationPlugin.js"],"sourcesContent":["const legendSetsQuery = {\n    legendSets: {\n        resource: 'legendSets',\n        params: ({ ids }) => ({\n            fields:\n                'id,legends[id,displayName~rename(name),startValue,endValue,color]',\n            filter: `id:in:[${ids.join(',')}]`,\n        }),\n    },\n}\n\nexport const apiFetchLegendSets = (dataEngine, ids) =>\n    dataEngine.query(legendSetsQuery, { variables: { ids } })\n","const orgUnitLevelsQuery = {\n    orgUnitsLevels: {\n        resource: 'organisationUnitLevels',\n        params: {\n            fields: 'id,level,displayName~rename(name)',\n            paging: 'false',\n        },\n    },\n}\n\nconst orgUnitsQuery = {\n    orgUnits: {\n        resource: 'organisationUnits',\n        id: ({ id }) => id,\n        params: {\n            fields:\n                'id,level,displayName~rename(name),parent[id,displayName~rename(name)],children[level]',\n            paging: 'false',\n            userDataViewFallback: 'true',\n        },\n    },\n}\n\nexport const apiFetchOrganisationUnitLevels = dataEngine =>\n    dataEngine.query(orgUnitLevelsQuery)\n\nexport const apiFetchOrganisationUnit = (dataEngine, id) =>\n    dataEngine.query(orgUnitsQuery, { variables: { id } })\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst ArrowUpwardIcon = ({ style = { width: 18, height: 18 } }) => (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" style={style}>\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n        <path\n            d=\"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z\"\n            fill=\"black\"\n        />\n    </svg>\n)\n\nArrowUpwardIcon.propTypes = {\n    style: PropTypes.object,\n}\n\nexport default ArrowUpwardIcon\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst ArrowDownwardIcon = ({ style = { width: 18, height: 18 } }) => (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" style={style}>\n        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n        <path\n            d=\"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z\"\n            fill=\"black\"\n        />\n    </svg>\n)\n\nArrowDownwardIcon.propTypes = {\n    style: PropTypes.object,\n}\n\nexport default ArrowDownwardIcon\n","import React, { useEffect, useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\n\nimport i18n from '@dhis2/d2-i18n'\nimport { useDataEngine } from '@dhis2/app-runtime'\nimport { Divider, Menu, MenuItem } from '@dhis2/ui-core'\n\nimport ArrowUpwardIcon from './assets/ArrowUpwardIcon'\nimport ArrowDownwardIcon from './assets/ArrowDownwardIcon'\n\nimport { apiFetchOrganisationUnit } from './api/organisationUnits'\n\nexport const ContextualMenu = ({ config, ouLevels, onClick }) => {\n    const engine = useDataEngine()\n    const [ouData, setOuData] = useState(undefined)\n    const [subLevelData, setSubLevelData] = useState(undefined)\n\n    const lookupLevel = levelId => ouLevels.find(item => item.level === levelId)\n\n    const doFetchOuData = useCallback(\n        async ouId => {\n            const ouData = await apiFetchOrganisationUnit(engine, ouId)\n\n            return ouData.orgUnits\n        },\n        [engine]\n    )\n\n    useEffect(() => {\n        setOuData(null)\n\n        const doFetch = async () => {\n            const orgUnit = await doFetchOuData(config.ouId)\n\n            setOuData(orgUnit)\n        }\n\n        if (config.ouId) {\n            doFetch()\n        }\n\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [config])\n\n    useEffect(() => {\n        setSubLevelData(null)\n\n        if (ouData?.children.length) {\n            const levelData = lookupLevel(ouData.children[0].level)\n\n            if (levelData) {\n                setSubLevelData(levelData)\n            }\n        }\n\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [ouData])\n\n    return (\n        <Menu>\n            {ouData && (\n                <MenuItem dense label={i18n.t('Org. unit drill down/up')}>\n                    <Menu>\n                        {subLevelData && (\n                            <>\n                                <MenuItem\n                                    dense\n                                    icon={<ArrowDownwardIcon />}\n                                    label={i18n.t(\n                                        'Show {{level}} level in {{orgunit}}',\n                                        {\n                                            level: subLevelData.name,\n                                            orgunit: ouData.name,\n                                        }\n                                    )}\n                                    onClick={() =>\n                                        onClick({\n                                            ou: {\n                                                id: ouData.id,\n                                                level: subLevelData.id,\n                                            },\n                                        })\n                                    }\n                                />\n                                {ouData?.parent && <Divider />}\n                            </>\n                        )}\n                        {ouData?.parent && (\n                            <MenuItem\n                                dense\n                                icon={<ArrowUpwardIcon />}\n                                label={i18n.t('Show {{orgunit}}', {\n                                    orgunit: ouData.parent.name,\n                                })}\n                                onClick={() =>\n                                    onClick({ ou: { id: ouData.parent.id } })\n                                }\n                            />\n                        )}\n                    </Menu>\n                </MenuItem>\n            )}\n        </Menu>\n    )\n}\n\nContextualMenu.propTypes = {\n    config: PropTypes.object,\n    ouLevels: PropTypes.array,\n    onClick: PropTypes.func,\n}\n\nexport default ContextualMenu\n","import React, { useRef, useCallback, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { isSingleValue, createVisualization } from '@dhis2/analytics'\n\nconst ChartPlugin = ({\n    visualization,\n    responses,\n    extraOptions,\n    legendSets,\n    id: renderCounter,\n    style,\n    onChartGenerated,\n    animation: defaultAnimation,\n}) => {\n    const canvasRef = useRef(undefined)\n\n    const renderVisualization = useCallback(\n        animation => {\n            const visualizationConfig = createVisualization(\n                responses,\n                visualization,\n                canvasRef.current,\n                {\n                    ...extraOptions,\n                    animation,\n                    legendSets,\n                },\n                undefined,\n                undefined,\n                isSingleValue(visualization.type) ? 'dhis' : 'highcharts' // output format\n            )\n\n            if (isSingleValue(visualization.type)) {\n                onChartGenerated(visualizationConfig.visualization)\n            } else {\n                onChartGenerated(\n                    visualizationConfig.visualization.getSVGForExport({\n                        sourceHeight: 768,\n                        sourceWidth: 1024,\n                    })\n                )\n            }\n        },\n        [\n            canvasRef,\n            visualization,\n            onChartGenerated,\n            responses,\n            extraOptions,\n            legendSets,\n        ]\n    )\n\n    useEffect(() => {\n        renderVisualization(defaultAnimation)\n\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [visualization, responses, extraOptions])\n\n    useEffect(() => {\n        renderVisualization(0)\n\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [renderCounter, style])\n\n    return <div ref={canvasRef} style={style} />\n}\n\nChartPlugin.defaultProps = {\n    visualization: {},\n    filters: {},\n    style: {},\n    animation: 200,\n    onChartGenerated: Function.prototype,\n}\n\nChartPlugin.propTypes = {\n    extraOptions: PropTypes.object.isRequired,\n    legendSets: PropTypes.arrayOf(PropTypes.object).isRequired,\n    responses: PropTypes.arrayOf(PropTypes.object).isRequired,\n    visualization: PropTypes.object.isRequired,\n    animation: PropTypes.number,\n    id: PropTypes.number,\n    style: PropTypes.object,\n    onChartGenerated: PropTypes.func,\n}\n\nexport default ChartPlugin\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport { PivotTable } from '@dhis2/analytics'\n\nconst PivotPlugin = ({\n    responses,\n    legendSets,\n    visualization,\n    style,\n    id: renderCounter,\n    onToggleContextualMenu,\n}) => {\n    return (\n        <div style={style}>\n            <PivotTable\n                visualization={visualization}\n                data={responses[0].response}\n                legendSets={legendSets}\n                renderCounter={renderCounter}\n                onToggleContextualMenu={onToggleContextualMenu}\n            />\n        </div>\n    )\n}\n\nPivotPlugin.defaultProps = {\n    style: {},\n}\n\nPivotPlugin.propTypes = {\n    legendSets: PropTypes.arrayOf(PropTypes.object).isRequired,\n    responses: PropTypes.arrayOf(PropTypes.object).isRequired,\n    visualization: PropTypes.object.isRequired,\n    id: PropTypes.number,\n    style: PropTypes.object,\n    onToggleContextualMenu: PropTypes.func,\n}\n\nexport default PivotPlugin\n","import { VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics'\n\nconst peId = 'pe'\n\nexport const apiFetchAnalytics = async (d2, current, options) => {\n    const req = new d2.analytics.request()\n        .fromModel(current)\n        .withParameters(options)\n        .withIncludeNumDen(current.type === VIS_TYPE_PIVOT_TABLE)\n\n    const rawResponse = await d2.analytics.aggregate.get(req)\n\n    return [new d2.analytics.response(rawResponse)]\n}\n\nexport const apiFetchAnalyticsForYearOverYear = async (\n    d2,\n    current,\n    options\n) => {\n    let yearlySeriesReq = new d2.analytics.request()\n        .addPeriodDimension(current.yearlySeries)\n        .withSkipData(true)\n        .withSkipMeta(false)\n        .withIncludeMetadataDetails(true)\n\n    if (options.relativePeriodDate) {\n        yearlySeriesReq = yearlySeriesReq.withRelativePeriodDate(\n            options.relativePeriodDate\n        )\n    }\n\n    const yearlySeriesRes = await d2.analytics.aggregate.fetch(yearlySeriesReq)\n\n    const requests = []\n    const yearlySeriesLabels = []\n\n    const now = new Date()\n    const currentDay = ('' + now.getDate()).padStart(2, 0)\n    const currentMonth = ('' + (now.getMonth() + 1)).padStart(2, 0)\n\n    yearlySeriesRes.metaData.dimensions[peId].forEach(period => {\n        yearlySeriesLabels.push(yearlySeriesRes.metaData.items[period].name)\n\n        const startDate = `${period}-${currentMonth}-${currentDay}`\n\n        const req = new d2.analytics.request()\n            .fromModel(current)\n            .withParameters(options)\n            .withRelativePeriodDate(startDate)\n\n        requests.push(d2.analytics.aggregate.get(req))\n    })\n\n    return Promise.all(requests).then(responses => ({\n        responses: responses.map(res => new d2.analytics.response(res)),\n        yearlySeriesLabels,\n    }))\n}\n","export const computeGenericPeriodNames = responses => {\n    const xAxisRes = responses.reduce((out, res) => {\n        if (out.metaData) {\n            if (\n                res.metaData.dimensions.pe.length >\n                out.metaData.dimensions.pe.length\n            ) {\n                out = res\n            }\n        } else {\n            out = res\n        }\n\n        return out\n    }, {})\n\n    const metadata = xAxisRes.metaData\n\n    return metadata.dimensions.pe.reduce((genericPeriodNames, periodId) => {\n        const name = metadata.items[periodId].name\n\n        // until the day the backend will support this in the API:\n        // trim off the trailing year in the period name\n        // english names should all have the year at the end of the string\n        genericPeriodNames.push(name.replace(/\\s+\\d{4}$/, ''))\n\n        return genericPeriodNames\n    }, [])\n}\n","import pick from 'lodash-es/pick'\n\nexport const options = {\n    baseLineLabel: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    baseLineValue: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    // colorSet:\n    cumulativeValues: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    domainAxisLabel: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    hideEmptyRowItems: {\n        defaultValue: 'NONE',\n        requestable: false,\n        savable: true,\n    },\n    hideLegend: { defaultValue: false, requestable: false, savable: true },\n    noSpaceBetweenColumns: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    percentStackedValues: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    rangeAxisDecimals: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    rangeAxisLabel: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    rangeAxisMaxValue: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    rangeAxisMinValue: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    rangeAxisSteps: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    regressionType: { defaultValue: 'NONE', requestable: false, savable: true },\n    showData: { defaultValue: true, requestable: false, savable: true },\n    targetLineLabel: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    targetLineValue: {\n        defaultValue: undefined,\n        requestable: false,\n        savable: true,\n    },\n    aggregationType: {\n        defaultValue: 'DEFAULT',\n        requestable: true,\n        savable: true,\n    },\n    completedOnly: { defaultValue: false, requestable: true, savable: true },\n    hideSubtitle: { defaultValue: false, requestable: false, savable: true },\n    hideTitle: { defaultValue: false, requestable: false, savable: true },\n    sortOrder: { defaultValue: '0', requestable: false, savable: true },\n    subtitle: { defaultValue: undefined, requestable: false, savable: true },\n    title: { defaultValue: undefined, requestable: false, savable: true },\n\n    // only for PT\n    colTotals: { defaultValue: false, requestable: false, savable: true },\n    colSubTotals: { defaultValue: false, requestable: false, savable: true },\n    rowTotals: { defaultValue: false, requestable: false, savable: true },\n    rowSubTotals: { defaultValue: false, requestable: false, savable: true },\n    showDimensionLabels: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    hideEmptyColumns: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    hideEmptyRows: { defaultValue: false, requestable: false, savable: true },\n    skipRounding: { defaultValue: false, requestable: true, savable: true },\n    numberType: { defaultValue: 'VALUE', requestable: false, savable: true },\n    showHierarchy: { defaultValue: false, requestable: true, savable: true },\n    legendSet: { defaultValue: undefined, requestable: false, savable: true },\n    legendDisplayStrategy: {\n        defaultValue: 'FIXED',\n        requestable: false,\n        savable: true,\n    },\n    legendDisplayStyle: {\n        defaultValue: 'FILL',\n        requestable: false,\n        savable: true,\n    },\n    displayDensity: {\n        defaultValue: 'NORMAL',\n        requestable: false,\n        savable: true,\n    },\n    fontSize: { defaultValue: 'NORMAL', requestable: false, savable: true },\n    digitGroupSeparator: {\n        defaultValue: 'SPACE',\n        requestable: false,\n        savable: true,\n    },\n    approvalLevel: {\n        defaultValue: undefined,\n        requestable: true,\n        savable: false,\n    },\n\n    // these are stored in the AO under reportingParams\n    reportingPeriod: { defaultValue: false, requestable: false, savable: true },\n    organisationUnit: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    parentOrganisationUnit: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    // not exposed in UI\n    grandParentOrganisationUnit: {\n        defaultValue: false,\n        requestable: false,\n        savable: true,\n    },\n    regression: { defaultValue: false, requestable: false, savable: true },\n    cumulative: { defaultValue: false, requestable: false, savable: true },\n    measureCriteria: {\n        defaultValue: undefined,\n        requestable: true,\n        savable: true,\n    },\n    topLimit: { defaultValue: '0', requestable: false, savable: true },\n}\n\nexport const computedOptions = {\n    baseLine: { defaultValue: false, requestable: false, savable: false },\n    targetLine: { defaultValue: false, requestable: false, savable: false },\n    axisRange: { defaultValue: undefined, requestable: false, savable: false },\n    legend: { defaultValue: undefined, requestable: false, savable: false },\n}\n\nexport default options\n\nexport const getOptionsForUi = () => {\n    return Object.entries({ ...options, ...computedOptions }).reduce(\n        (map, [option, props]) => {\n            map[option] = props.defaultValue\n\n            return map\n        },\n        {}\n    )\n}\n\nexport const getOptionsForRequest = () => {\n    return Object.entries(options).filter(\n        entry => entry[1].requestable // entry = [option, props]\n    )\n}\n\nconst isNotDefault = (optionsFromVisualization, prop) => {\n    return Boolean(\n        optionsFromVisualization[prop] &&\n            optionsFromVisualization[prop] !== options[prop].defaultValue\n    )\n}\n\nexport const getOptionsFromVisualization = visualization => {\n    const optionsFromVisualization = {\n        ...getOptionsForUi(),\n        ...pick(visualization, Object.keys(options)),\n    }\n\n    optionsFromVisualization.baseLine =\n        isNotDefault(optionsFromVisualization, 'baseLineLabel') ||\n        isNotDefault(optionsFromVisualization, 'baseLineValue')\n\n    optionsFromVisualization.targetLine =\n        isNotDefault(optionsFromVisualization, 'targetLineLabel') ||\n        isNotDefault(optionsFromVisualization, 'targetLineValue')\n\n    // nested options under reportingParams\n    if (visualization.reportingParams) {\n        optionsFromVisualization.organisationUnit =\n            visualization.reportingParams.organisationUnit\n        optionsFromVisualization.reportingPeriod =\n            visualization.reportingParams.reportingPeriod\n        optionsFromVisualization.parentOrganisationUnit =\n            visualization.reportingParams.parentOrganisationUnit\n        optionsFromVisualization.grandParentOrganisationUnit =\n            visualization.reportingParams.grandParentOrganisationUnit\n    }\n\n    // cast option values from Number for some options\n    ;['baseLineValue', 'targetLineValue', 'sortOrder', 'topLimit'].forEach(\n        option => {\n            if (Object.prototype.hasOwnProperty.call(visualization, option)) {\n                optionsFromVisualization[option] = String(visualization[option])\n            }\n        }\n    )\n\n    return optionsFromVisualization\n}\n","import { getOptionsForRequest } from './options'\n\nexport const getRequestOptions = (visualization, filters) => {\n    const options = getOptionsForRequest().reduce((map, [option, props]) => {\n        // only add parameter if value !== default\n        if (\n            visualization[option] !== undefined &&\n            visualization[option] !== props.defaultValue\n        ) {\n            map[option] = visualization[option]\n        }\n\n        return map\n    }, {})\n\n    // interpretation filter\n    if (filters.relativePeriodDate) {\n        options.relativePeriodDate = filters.relativePeriodDate\n    }\n\n    // global filters\n    // userOrgUnit\n    if (filters.userOrgUnit && filters.userOrgUnit.length) {\n        const ouIds = filters.userOrgUnit.map(\n            ouPath => ouPath.split('/').slice(-1)[0]\n        )\n\n        options.userOrgUnit = ouIds.join(';')\n    }\n\n    return options\n}\n","import i18n from '@dhis2/d2-i18n'\nimport { isYearOverYear } from '@dhis2/analytics'\nimport {\n    apiFetchAnalyticsForYearOverYear,\n    apiFetchAnalytics,\n} from '../api/analytics'\nimport { computeGenericPeriodNames } from './analytics'\nimport { getRequestOptions } from './getRequestOptions'\n\nexport const fetchData = async ({\n    visualization,\n    filters,\n    d2,\n    forDashboard,\n}) => {\n    const options = getRequestOptions(visualization, filters)\n\n    const extraOptions = {\n        dashboard: forDashboard,\n        noData: { text: i18n.t('No data') },\n    }\n\n    if (isYearOverYear(visualization.type)) {\n        const {\n            responses,\n            yearlySeriesLabels,\n        } = await apiFetchAnalyticsForYearOverYear(d2, visualization, options)\n\n        return {\n            responses,\n            extraOptions: {\n                ...extraOptions,\n                yearlySeries: yearlySeriesLabels,\n                xAxisLabels: computeGenericPeriodNames(responses),\n            },\n        }\n    }\n\n    return {\n        responses: await apiFetchAnalytics(d2, visualization, options),\n        extraOptions,\n    }\n}\n","export default {\n    backdrop: {\n        position: 'fixed',\n        height: '100%',\n        width: '100%',\n        top: 0,\n        left: 0,\n        backgroundColor: 'transparent',\n    },\n}\n","import React, { useEffect, useState, useCallback } from 'react'\nimport { createPortal } from 'react-dom'\nimport PropTypes from 'prop-types'\n\nimport { useDataEngine } from '@dhis2/app-runtime'\nimport { Popper } from '@dhis2/ui-core'\nimport { VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics'\n\nimport { apiFetchLegendSets } from './api/legendSets'\nimport { apiFetchOrganisationUnitLevels } from './api/organisationUnits'\nimport ContextualMenu from './ContextualMenu'\nimport ChartPlugin from './ChartPlugin'\nimport PivotPlugin from './PivotPlugin'\nimport { fetchData } from './modules/fetchData'\n\nimport styles from './styles/VisualizationPlugin.style.js'\n\nconst LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM = 'BY_DATA_ITEM'\nconst LEGEND_DISPLAY_STRATEGY_FIXED = 'FIXED'\n\nexport const VisualizationPlugin = ({\n    d2,\n    visualization,\n    filters,\n    forDashboard,\n    onError,\n    onLoadingComplete,\n    onResponsesReceived,\n    onDrill,\n    ...props\n}) => {\n    const engine = useDataEngine()\n    const [fetchResult, setFetchResult] = useState(null)\n    const [contextualMenuRef, setContextualMenuRef] = useState(undefined)\n    const [contextualMenuConfig, setContextualMenuConfig] = useState({})\n    const [ouLevels, setOuLevels] = useState(null)\n\n    const onToggleContextualMenu = (ref, data) => {\n        setContextualMenuRef(ref)\n        setContextualMenuConfig(data)\n    }\n\n    const closeContextualMenu = () => setContextualMenuRef(undefined)\n\n    const onContextualMenuItemClick = args => {\n        closeContextualMenu()\n\n        if (args.ou) {\n            const ouItems = [{ id: args.ou.id, name: args.ou.name }]\n\n            if (args.ou.level) {\n                const levelData = ouLevels.find(\n                    item => item.id === args.ou.level\n                )\n\n                ouItems.push({\n                    id: levelData.id,\n                    name: levelData.name,\n                })\n            }\n        }\n\n        onDrill(args)\n    }\n\n    const doFetchData = useCallback(async () => {\n        const result = await fetchData({\n            visualization,\n            filters,\n            d2,\n            forDashboard,\n        })\n\n        if (result.responses.length) {\n            onResponsesReceived(result.responses)\n        }\n\n        return result\n    }, [d2, filters, forDashboard, onResponsesReceived, visualization])\n\n    const doFetchLegendSets = useCallback(\n        async legendSetIds => {\n            if (!legendSetIds.length) {\n                return []\n            }\n\n            const response = await apiFetchLegendSets(engine, legendSetIds)\n\n            if (response && response.legendSets) {\n                return response.legendSets.legendSets\n            }\n        },\n        [engine]\n    )\n\n    const doFetchOuLevelsData = useCallback(async () => {\n        const ouLevelsData = await apiFetchOrganisationUnitLevels(engine)\n\n        return ouLevelsData.orgUnitsLevels.organisationUnitLevels\n    }, [engine])\n\n    useEffect(() => {\n        const doFetch = async () => {\n            const orgUnitLevels = await doFetchOuLevelsData()\n\n            setOuLevels(orgUnitLevels)\n        }\n\n        doFetch().catch(error => onError(error))\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [])\n\n    useEffect(() => {\n        setFetchResult(null)\n\n        const doFetchAll = async () => {\n            const { responses, extraOptions } = await doFetchData(\n                visualization,\n                filters,\n                forDashboard\n            )\n\n            const legendSetIds = []\n\n            switch (visualization.legendDisplayStrategy) {\n                case LEGEND_DISPLAY_STRATEGY_FIXED:\n                    if (visualization.legendSet && visualization.legendSet.id) {\n                        legendSetIds.push(visualization.legendSet.id)\n                    }\n                    break\n                case LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM: {\n                    // parse responses to extract legendSet ids from metaData\n                    // multiple responses are only for YOY which does not support legends\n                    // safe to use only the 1st\n                    // dx dimensions might not be present, the empty array covers that case\n                    const dxIds = responses[0].metaData.dimensions.dx || []\n\n                    dxIds.forEach(dxId => {\n                        const legendSetId =\n                            responses[0].metaData.items[dxId].legendSet\n\n                        if (legendSetId) {\n                            legendSetIds.push(legendSetId)\n                        }\n                    })\n\n                    break\n                }\n            }\n\n            const legendSets = await doFetchLegendSets(legendSetIds)\n\n            setFetchResult({\n                visualization,\n                legendSets,\n                responses,\n                extraOptions,\n            })\n            onLoadingComplete()\n        }\n\n        doFetchAll().catch(error => {\n            onError(error)\n        })\n\n        /* eslint-disable-next-line react-hooks/exhaustive-deps */\n    }, [visualization, filters, forDashboard])\n\n    if (!fetchResult) {\n        return null\n    }\n\n    return (\n        <>\n            {!fetchResult.visualization.type ||\n            fetchResult.visualization.type === VIS_TYPE_PIVOT_TABLE ? (\n                <PivotPlugin\n                    visualization={fetchResult.visualization}\n                    responses={fetchResult.responses}\n                    legendSets={fetchResult.legendSets}\n                    onToggleContextualMenu={onToggleContextualMenu}\n                    {...props}\n                />\n            ) : (\n                <ChartPlugin\n                    visualization={fetchResult.visualization}\n                    responses={fetchResult.responses}\n                    extraOptions={fetchResult.extraOptions}\n                    legendSets={fetchResult.legendSets}\n                    {...props}\n                />\n            )}\n            {contextualMenuRef &&\n                createPortal(\n                    <div onClick={closeContextualMenu} style={styles.backdrop}>\n                        <Popper reference={contextualMenuRef} placement=\"right\">\n                            <ContextualMenu\n                                config={contextualMenuConfig}\n                                ouLevels={ouLevels}\n                                onClick={onContextualMenuItemClick}\n                            />\n                        </Popper>\n                    </div>,\n                    document.body\n                )}\n        </>\n    )\n}\n\nVisualizationPlugin.defaultProps = {\n    filters: {},\n    forDashboard: false,\n    onDrill: Function.prototype,\n    onError: Function.prototype,\n    onLoadingComplete: Function.prototype,\n    onResponsesReceived: Function.prototype,\n    visualization: {},\n}\nVisualizationPlugin.propTypes = {\n    d2: PropTypes.object.isRequired,\n    visualization: PropTypes.object.isRequired,\n    filters: PropTypes.object,\n    forDashboard: PropTypes.bool,\n    onDrill: PropTypes.func,\n    onError: PropTypes.func,\n    onLoadingComplete: PropTypes.func,\n    onResponsesReceived: PropTypes.func,\n}\n"],"names":["legendSetsQuery","legendSets","resource","params","ids","fields","filter","join","apiFetchLegendSets","dataEngine","query","variables","orgUnitLevelsQuery","orgUnitsLevels","paging","orgUnitsQuery","orgUnits","id","userDataViewFallback","apiFetchOrganisationUnitLevels","apiFetchOrganisationUnit","ArrowUpwardIcon","style","width","height","React","propTypes","PropTypes","object","ArrowDownwardIcon","ContextualMenu","config","ouLevels","onClick","engine","useDataEngine","useState","undefined","ouData","setOuData","subLevelData","setSubLevelData","lookupLevel","levelId","find","item","level","doFetchOuData","useCallback","ouId","useEffect","doFetch","orgUnit","children","length","levelData","Menu","MenuItem","i18n","t","name","orgunit","ou","parent","Divider","array","func","ChartPlugin","visualization","responses","extraOptions","renderCounter","onChartGenerated","defaultAnimation","animation","canvasRef","useRef","renderVisualization","visualizationConfig","createVisualization","current","isSingleValue","type","getSVGForExport","sourceHeight","sourceWidth","defaultProps","filters","Function","prototype","isRequired","arrayOf","number","PivotPlugin","onToggleContextualMenu","PivotTable","response","peId","apiFetchAnalytics","d2","options","req","analytics","request","fromModel","withParameters","withIncludeNumDen","VIS_TYPE_PIVOT_TABLE","aggregate","get","rawResponse","apiFetchAnalyticsForYearOverYear","yearlySeriesReq","addPeriodDimension","yearlySeries","withSkipData","withSkipMeta","withIncludeMetadataDetails","relativePeriodDate","withRelativePeriodDate","fetch","yearlySeriesRes","requests","yearlySeriesLabels","now","Date","currentDay","getDate","padStart","currentMonth","getMonth","metaData","dimensions","forEach","period","push","items","startDate","Promise","all","then","map","res","computeGenericPeriodNames","xAxisRes","reduce","out","pe","metadata","genericPeriodNames","periodId","replace","baseLineLabel","defaultValue","requestable","savable","baseLineValue","cumulativeValues","domainAxisLabel","hideEmptyRowItems","hideLegend","noSpaceBetweenColumns","percentStackedValues","rangeAxisDecimals","rangeAxisLabel","rangeAxisMaxValue","rangeAxisMinValue","rangeAxisSteps","regressionType","showData","targetLineLabel","targetLineValue","aggregationType","completedOnly","hideSubtitle","hideTitle","sortOrder","subtitle","title","colTotals","colSubTotals","rowTotals","rowSubTotals","showDimensionLabels","hideEmptyColumns","hideEmptyRows","skipRounding","numberType","showHierarchy","legendSet","legendDisplayStrategy","legendDisplayStyle","displayDensity","fontSize","digitGroupSeparator","approvalLevel","reportingPeriod","organisationUnit","parentOrganisationUnit","grandParentOrganisationUnit","regression","cumulative","measureCriteria","topLimit","getOptionsForRequest","Object","entries","entry","getRequestOptions","option","props","userOrgUnit","ouIds","ouPath","split","slice","fetchData","forDashboard","dashboard","noData","text","isYearOverYear","xAxisLabels","backdrop","position","top","left","backgroundColor","LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM","LEGEND_DISPLAY_STRATEGY_FIXED","VisualizationPlugin","onError","onLoadingComplete","onResponsesReceived","onDrill","fetchResult","setFetchResult","contextualMenuRef","setContextualMenuRef","contextualMenuConfig","setContextualMenuConfig","setOuLevels","ref","data","closeContextualMenu","onContextualMenuItemClick","args","ouItems","doFetchData","result","doFetchLegendSets","legendSetIds","doFetchOuLevelsData","ouLevelsData","organisationUnitLevels","orgUnitLevels","catch","error","doFetchAll","dxIds","dx","dxId","legendSetId","createPortal","styles","Popper","document","body","bool"],"mappings":"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"}